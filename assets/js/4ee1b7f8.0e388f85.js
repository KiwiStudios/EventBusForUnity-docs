"use strict";(self.webpackChunkeventbusforunity=self.webpackChunkeventbusforunity||[]).push([[875],{2602:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"getting-started/basic-usage","title":"Basic usage","description":"Quick start","source":"@site/docs/getting-started/basic-usage.md","sourceDirName":"getting-started","slug":"/getting-started/basic-usage","permalink":"/EventBusForUnity-docs/getting-started/basic-usage","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"documentationSidebar","previous":{"title":"Getting Started","permalink":"/EventBusForUnity-docs/category/getting-started"},"next":{"title":"Customizing registration in MonoBehaviours","permalink":"/EventBusForUnity-docs/getting-started/configure-registration-and-deregistration"}}');var i=t(4848),o=t(8453);const r={sidebar_position:1},a="Basic usage",l={},d=[{value:"Quick start",id:"quick-start",level:2},{value:"How does this work?",id:"how-does-this-work",level:2},{value:"Note on <code>EventBus.Initialize()</code>",id:"note-on-eventbusinitialize",level:3},{value:"EventBus per Assembly",id:"eventbus-per-assembly",level:2},{value:"Inspecting the source generated files",id:"inspecting-the-source-generated-files",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"basic-usage",children:"Basic usage"})}),"\n",(0,i.jsx)(n.h2,{id:"quick-start",children:"Quick start"}),"\n",(0,i.jsxs)(n.p,{children:["To get started, add something like the following to any class inheriting from ",(0,i.jsx)(n.code,{children:"MonoBehaviour"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"using Assembly_CSharp.EventBusForUnity; // Note: per assembly an EventBus is generated, so this might have a different prefix than 'Assembly_CSharp'\nusing EventBusForUnity;\nusing UnityEngine; \n\npublic class OnHelloWorldEvent\n{\n    public string Message; \n}\n\npublic partial class HelloWorldExample : MonoBehaviour\n{\n    [Listener]\n    private void OnHelloWorld(OnHelloWorldEvent evnt)\n    {\n        // do whatever you want to do\n        Debug.Log(evnt.Message);\n    }\n\n    private void Awake()\n    {\n        // Important! Call this (preferably) once in the entrypoint of your game, the first possible thing (e.g. when loading resources, etc)\n        EventBus.Initialize(); \n    }\n\n    void Start()\n    {\n        EventBus.Send(new OnHelloWorldEvent()\n        {\n            Message = \"Hello World from EventBus for Unity!\"\n        });\n    }\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Re-focus Unity for the source generator to be automatically setup, and press play. You should see a log entry in Unity when running this now."}),"\n",(0,i.jsx)(n.h2,{id:"how-does-this-work",children:"How does this work?"}),"\n",(0,i.jsxs)(n.p,{children:["First, you call ",(0,i.jsx)(n.code,{children:"EventBus.Initialize()"})," on the entrypoint of your game, the Awake() method of a GameManager or somewhere else."]}),"\n",(0,i.jsxs)(n.p,{children:["When you add the ",(0,i.jsx)(n.code,{children:"[Listener]"})," attribute to your method the source generator automatically generates the necessary methods to register and unregister your listener.\nThis significantly reduces the overhead (and potential memory leaks) when following the EventBus pattern."]}),"\n",(0,i.jsx)(n.p,{children:"You can learn more on how to configure where the (de)registration of your listener methods happens in the next chapters."}),"\n",(0,i.jsxs)(n.h3,{id:"note-on-eventbusinitialize",children:["Note on ",(0,i.jsx)(n.code,{children:"EventBus.Initialize()"})]}),"\n",(0,i.jsxs)(n.p,{children:["It's important that you call ",(0,i.jsx)(n.code,{children:"EventBus.Initialize()"})," before you expect calls to go to your listener methods."]}),"\n",(0,i.jsxs)(n.p,{children:["If you call ",(0,i.jsx)(n.code,{children:"EventBus.Initialize()"})," inside your ",(0,i.jsx)(n.code,{children:"Start()"})," method where you also have ",(0,i.jsx)(n.code,{children:"Listeners"})," defined, it will not work. ",(0,i.jsx)(n.code,{children:"EventBus.Initialize()"})," needs to be called ",(0,i.jsx)(n.strong,{children:"before"})," ",(0,i.jsx)(n.code,{children:"Start()"}),". The order of execution for ",(0,i.jsx)(n.code,{children:"Start()"})," is as follows: the patched ",(0,i.jsx)(n.code,{children:"Start()"})," that registers ",(0,i.jsx)(n.code,{children:"Listeners"})," -> your ",(0,i.jsx)(n.code,{children:"Start()"})," implementation -> ",(0,i.jsx)(n.code,{children:"EventBus.Initialize()"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Since this must happen before the ",(0,i.jsx)(n.code,{children:"Listeners"})," are registered, a simple solution is to call ",(0,i.jsx)(n.code,{children:"EventBus.Initialize()"})," inside the ",(0,i.jsx)(n.code,{children:"Awake()"})," method."]}),"\n",(0,i.jsx)(n.h2,{id:"eventbus-per-assembly",children:"EventBus per Assembly"}),"\n",(0,i.jsx)(n.p,{children:"The source generator automatically gets the name of the assembly.\nThis is the .csproj name usually, or the name defined in the .asmdef file."}),"\n",(0,i.jsxs)(n.p,{children:["By default, in Unity the assembly name is ",(0,i.jsx)(n.code,{children:"Assembly-CSharp"})," of your code unless you are using Unity's ",(0,i.jsx)(n.a,{href:"https://docs.unity3d.com/6000.0/Documentation/Manual/assembly-definition-files.html",children:"Assembly feature"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["For instance, if you define a custom assembly using ",(0,i.jsx)(n.code,{children:"src.asmdef"}),", the EventBus will be accessible under the ",(0,i.jsx)(n.code,{children:"src.EventBusForUnity"})," namespace."]}),"\n",(0,i.jsxs)(n.p,{children:["If you are not using ",(0,i.jsx)(n.code,{children:".asmdef"})," files, the prefix will default to what is shown in the initial code snippet."]}),"\n",(0,i.jsx)(n.h2,{id:"inspecting-the-source-generated-files",children:"Inspecting the source generated files"}),"\n",(0,i.jsxs)(n.p,{children:["If you are curious, or are wondering on how the EventBus logic works internally, then you can view the source generated files for your assembly quite easily. Using Rider you can find the generated files via the below screenshot.\n",(0,i.jsx)(n.img,{alt:"source-generated-files-location",src:t(7157).A+"",width:"488",height:"336"})]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},7157:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/source-generated-files-location-9dae55b3753e26491592d34faa5d8e57.png"},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var s=t(6540);const i={},o=s.createContext(i);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);